<!--
Pour exploitation des syslogs pfsense / version >= 2023.
-->

<!-- PFSENSE 2.6
2023 Jun 16 18:54:43 wazuh-server->192.168.0.254 1 2023-06-16T18:54:42.990985+02:00 Jack.dudes.lan filterlog 74239 - - 6,,,1000000105,vtnet0,matc>
-->

<!-- identifier les Logs venant d'un Firewall PfSense -->
<decoder name="pf-Firewall">
  <prematch type="pcre2">pf.*filterlog</prematch>
</decoder>

<!-- recuperer les champs venant d'un Firewall PfSense -->
<decoder name="pf-Firewall-Fields">
  <parent>pf-Firewall</parent>
  <regex type="pcre2">.*?- - .*?,.*?,.*?,(.*?),(.*?),.*?,(.*?),.*?,.*?,.*?,.*?,.*?,.*?,.*?,.*?,.*?,(.*?),.*?,(.*?),(.*?),(.*?),(.*?),</regex>
  <order>id,interface,action, protocol,srcip,dstip,scrport,dstport</order>
</decoder>

<!-- PFSENSE 2.6
2024 Oct 27 10:49:57 wazuh-server->192.168.2.154 1 2024-10-27T11:49:58.415961+01:00 pfSense.ysense.lan php-fpm 78244 - - /index.php: Successful l>
2024 Oct 27 10:50:03 wazuh-server->192.168.2.154 1 2024-10-27T11:50:05.219381+01:00 pfSense.ysense.lan php-fpm 398 - - /index.php: webConfigurato>
-->

<!-- identifier les Logs venant d'une IHM PfSense -->
<decoder name="pf-IHM">
  <prematch type="pcre2">pf.*php-fpm</prematch>
</decoder>

<!-- recuperer les champs venant d'une IHM pfSense -->
<decoder name="pf-IHM-Fields">
  <parent>pf-IHM</parent>
  <regex type="pcre2">(Successful|error).*?user '(.*?)' from: (\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b)</regex>
  <order>action,dstuser,scrip</order>
</decoder>






